!function(e){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const n=new class{constructor(){this.lmsHost=window.uef.__lmsHost,this.token=window.uef.__token,this.tokenRefresh=window.uef.__tokenRefresh,this.tokenExpiration=window.uef.__tokenExpiration,this.locale=window.uef.__locale,this.assets=window.uef.__assets,this.debug=!!window.uef.__debug,window.uef.__ltiHandlers&&(this.ltiHandlers=window.uef.__ltiHandlers)}};let a;function r(){return a}const s=e=>{r()?(n.debug&&console.log("Sending Message ".concat(e.type),e),r().postMessage(e)):console.warn("Unable to send message ".concat(e.type," ultraMessageChannel is not defined"),e)};class o{constructor(){t(this,"_portalId",""),t(this,"_content",{}),t(this,"_onRenderContent",(e=>{e({})})),t(this,"_callbacks",{})}doRender(e,t){if(!e&&!this._portalId||!this._onRenderContent)return;const n=null!=e?e:this.renderCallback.bind(this);this._onRenderContent(n,t)}renderCallback(e){var t;"boolean"==typeof e&&!1===e||(t=this._portalId,s({type:"portal:render",portalId:t,contents:e}))}render(e){this._onRenderContent=e}addPortalCallback(e,t){this._callbacks[e]=t}doesPortalCallbackExist(e){return Object.keys(this._callbacks).includes(e)}executePortalCallback(e){if(this.doesPortalCallbackExist(e))return this._callbacks[e]()}get portalId(){return this._portalId}get content(){return this._content}set content(e){this._content=e,this._portalId&&this._content&&this.doRender()}}class i{constructor(){t(this,"_addedIntegrations",[])}doesIntegrationExist(e){return this._addedIntegrations.includes(e)}addIntegration(e){this._addedIntegrations.push(e)}processEvent(e){this._addedIntegrations.forEach((t=>t.handleEvent(e)))}get addedIntegrations(){return this._addedIntegrations}}class l extends i{create(e){return this.panel=new c(e),this.addIntegration(this.panel),this.panel}}class c extends o{constructor(e){super(),this._correlationId=e}open(e){const t={type:"portal:panel",attributes:{},correlationId:this._correlationId,panelTitle:e.panelTitle,panelSubtitle:e.panelSubtitle,panelType:"full",useCustomPadding:e.useCustomPadding};s(t)}close(){if(!this._portalId)return;const e={type:"portal:panel:close",id:this._portalId};s(e)}handleEvent(e){switch(e.type){case"portal:panel:response":this.handlePanelResponse(e);break;case"event:event":this.handleUEFEvent(e);break;case"portal:callback":this.handlePortalCallback(e)}}handlePanelResponse(e){"failure"!==e.status&&e.correlationId===this._correlationId&&(this._portalId=e.portalId,this.doRender())}handleUEFEvent(e){if("portal:remove"===e.eventType)this.handlePortalRemove(e)}handlePortalCallback(e){e.portalId===this._portalId&&this.executePortalCallback(e.callbackId)}handlePortalRemove(e){this._portalId===e.portalId&&(this._portalId="")}}class u extends i{create(e){return this.modal=new d(e),this.addIntegration(this.modal),this.modal}}class d extends o{constructor(e){super(),this._modalId=e}close(){const e={type:"portal:modal:close",modalId:this._modalId};s(e)}open(){this.doRender((e=>{const t={type:"portal:modal",modalId:this._modalId,contents:e};s(t)}))}handleEvent(e){switch(e.type){case"portal:modal:response":this.handleModalResponse(e);break;case"portal:callback":this.handlePortalCallback(e)}}handleModalResponse(e){this._portalId=e.portalId}handlePortalCallback(e){e.portalId===this._portalId&&this.executePortalCallback(e.callbackId)}}var m="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},h=Function.prototype,p=h.apply,f=h.bind,b=h.call,g="object"==typeof Reflect&&Reflect.apply||(f?b.bind(p):function(){return b.apply(p,arguments)}),y=Function.prototype.call,v=y.bind?y.bind(y):function(){return y.apply(y,arguments)},M=Function.prototype,E=M.bind,T=M.call,_=E&&E.bind(T,T),w=E?function(e){return e&&_(e)}:function(e){return e&&function(){return T.apply(e,arguments)}},C=function(e){return e&&e.Math==Math&&e},O=C("object"==typeof globalThis&&globalThis)||C("object"==typeof window&&window)||C("object"==typeof self&&self)||C("object"==typeof m&&m)||function(){return this}()||Function("return this")(),I={},D=function(e){try{return!!e()}catch(e){return!0}},S=!D((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),k={},P={}.propertyIsEnumerable,R=Object.getOwnPropertyDescriptor,x=R&&!P.call({1:2},1);k.f=x?function(e){var t=R(this,e);return!!t&&t.enumerable}:P;var j,L,A=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},N=w,U=N({}.toString),B=N("".slice),H=function(e){return B(U(e),8,-1)},F=w,z=D,K=H,G=O.Object,q=F("".split),$=z((function(){return!G("z").propertyIsEnumerable(0)}))?function(e){return"String"==K(e)?q(e,""):G(e)}:G,W=O.TypeError,Y=function(e){if(null==e)throw W("Can't call method on "+e);return e},V=$,J=Y,X=function(e){return V(J(e))},Q=function(e){return"function"==typeof e},Z=Q,ee=function(e){return"object"==typeof e?null!==e:Z(e)},te=O,ne=Q,ae=function(e){return ne(e)?e:void 0},re=function(e,t){return arguments.length<2?ae(te[e]):te[e]&&te[e][t]},se=w({}.isPrototypeOf),oe=O,ie=re("navigator","userAgent")||"",le=oe.process,ce=oe.Deno,ue=le&&le.versions||ce&&ce.version,de=ue&&ue.v8;de&&(L=(j=de.split("."))[0]>0&&j[0]<4?1:+(j[0]+j[1])),!L&&ie&&(!(j=ie.match(/Edge\/(\d+)/))||j[1]>=74)&&(j=ie.match(/Chrome\/(\d+)/))&&(L=+j[1]);var me=L,he=D,pe=!!Object.getOwnPropertySymbols&&!he((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&me&&me<41})),fe=pe&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,be=re,ge=Q,ye=se,ve=fe,Me=O.Object,Ee=ve?function(e){return"symbol"==typeof e}:function(e){var t=be("Symbol");return ge(t)&&ye(t.prototype,Me(e))},Te=O.String,_e=Q,we=function(e){try{return Te(e)}catch(e){return"Object"}},Ce=O.TypeError,Oe=function(e){if(_e(e))return e;throw Ce(we(e)+" is not a function")},Ie=function(e,t){var n=e[t];return null==n?void 0:Oe(n)},De=v,Se=Q,ke=ee,Pe=O.TypeError,Re={exports:{}},xe=O,je=Object.defineProperty,Le=function(e,t){try{je(xe,e,{value:t,configurable:!0,writable:!0})}catch(n){xe[e]=t}return t},Ae=Le,Ne="__core-js_shared__",Ue=O[Ne]||Ae(Ne,{}),Be=Ue;(Re.exports=function(e,t){return Be[e]||(Be[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.2",mode:"global",copyright:"Â© 2022 Denis Pushkarev (zloirock.ru)"});var He=Y,Fe=O.Object,ze=function(e){return Fe(He(e))},Ke=ze,Ge=w({}.hasOwnProperty),qe=Object.hasOwn||function(e,t){return Ge(Ke(e),t)},$e=w,We=0,Ye=Math.random(),Ve=$e(1..toString),Je=function(e){return"Symbol("+(void 0===e?"":e)+")_"+Ve(++We+Ye,36)},Xe=O,Qe=Re.exports,Ze=qe,et=Je,tt=pe,nt=fe,at=Qe("wks"),rt=Xe.Symbol,st=rt&&rt.for,ot=nt?rt:rt&&rt.withoutSetter||et,it=function(e){if(!Ze(at,e)||!tt&&"string"!=typeof at[e]){var t="Symbol."+e;tt&&Ze(rt,e)?at[e]=rt[e]:at[e]=nt&&st?st(t):ot(t)}return at[e]},lt=v,ct=ee,ut=Ee,dt=Ie,mt=function(e,t){var n,a;if("string"===t&&Se(n=e.toString)&&!ke(a=De(n,e)))return a;if(Se(n=e.valueOf)&&!ke(a=De(n,e)))return a;if("string"!==t&&Se(n=e.toString)&&!ke(a=De(n,e)))return a;throw Pe("Can't convert object to primitive value")},ht=it,pt=O.TypeError,ft=ht("toPrimitive"),bt=function(e,t){if(!ct(e)||ut(e))return e;var n,a=dt(e,ft);if(a){if(void 0===t&&(t="default"),n=lt(a,e,t),!ct(n)||ut(n))return n;throw pt("Can't convert object to primitive value")}return void 0===t&&(t="number"),mt(e,t)},gt=Ee,yt=function(e){var t=bt(e,"string");return gt(t)?t:t+""},vt=ee,Mt=O.document,Et=vt(Mt)&&vt(Mt.createElement),Tt=function(e){return Et?Mt.createElement(e):{}},_t=Tt,wt=!S&&!D((function(){return 7!=Object.defineProperty(_t("div"),"a",{get:function(){return 7}}).a})),Ct=S,Ot=v,It=k,Dt=A,St=X,kt=yt,Pt=qe,Rt=wt,xt=Object.getOwnPropertyDescriptor;I.f=Ct?xt:function(e,t){if(e=St(e),t=kt(t),Rt)try{return xt(e,t)}catch(e){}if(Pt(e,t))return Dt(!Ot(It.f,e,t),e[t])};var jt={},Lt=S&&D((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),At=O,Nt=ee,Ut=At.String,Bt=At.TypeError,Ht=function(e){if(Nt(e))return e;throw Bt(Ut(e)+" is not an object")},Ft=S,zt=wt,Kt=Lt,Gt=Ht,qt=yt,$t=O.TypeError,Wt=Object.defineProperty,Yt=Object.getOwnPropertyDescriptor,Vt="enumerable",Jt="configurable",Xt="writable";jt.f=Ft?Kt?function(e,t,n){if(Gt(e),t=qt(t),Gt(n),"function"==typeof e&&"prototype"===t&&"value"in n&&Xt in n&&!n.writable){var a=Yt(e,t);a&&a.writable&&(e[t]=n.value,n={configurable:Jt in n?n.configurable:a.configurable,enumerable:Vt in n?n.enumerable:a.enumerable,writable:!1})}return Wt(e,t,n)}:Wt:function(e,t,n){if(Gt(e),t=qt(t),Gt(n),zt)try{return Wt(e,t,n)}catch(e){}if("get"in n||"set"in n)throw $t("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var Qt=jt,Zt=A,en=S?function(e,t,n){return Qt.f(e,t,Zt(1,n))}:function(e,t,n){return e[t]=n,e},tn={exports:{}},nn=Q,an=Ue,rn=w(Function.toString);nn(an.inspectSource)||(an.inspectSource=function(e){return rn(e)});var sn,on,ln,cn=an.inspectSource,un=Q,dn=cn,mn=O.WeakMap,hn=un(mn)&&/native code/.test(dn(mn)),pn=Re.exports,fn=Je,bn=pn("keys"),gn=function(e){return bn[e]||(bn[e]=fn(e))},yn={},vn=hn,Mn=O,En=w,Tn=ee,_n=en,wn=qe,Cn=Ue,On=gn,In=yn,Dn="Object already initialized",Sn=Mn.TypeError,kn=Mn.WeakMap;if(vn||Cn.state){var Pn=Cn.state||(Cn.state=new kn),Rn=En(Pn.get),xn=En(Pn.has),jn=En(Pn.set);sn=function(e,t){if(xn(Pn,e))throw new Sn(Dn);return t.facade=e,jn(Pn,e,t),t},on=function(e){return Rn(Pn,e)||{}},ln=function(e){return xn(Pn,e)}}else{var Ln=On("state");In[Ln]=!0,sn=function(e,t){if(wn(e,Ln))throw new Sn(Dn);return t.facade=e,_n(e,Ln,t),t},on=function(e){return wn(e,Ln)?e[Ln]:{}},ln=function(e){return wn(e,Ln)}}var An={set:sn,get:on,has:ln,enforce:function(e){return ln(e)?on(e):sn(e,{})},getterFor:function(e){return function(t){var n;if(!Tn(t)||(n=on(t)).type!==e)throw Sn("Incompatible receiver, "+e+" required");return n}}},Nn=S,Un=qe,Bn=Function.prototype,Hn=Nn&&Object.getOwnPropertyDescriptor,Fn=Un(Bn,"name"),zn={EXISTS:Fn,PROPER:Fn&&"something"===function(){}.name,CONFIGURABLE:Fn&&(!Nn||Nn&&Hn(Bn,"name").configurable)},Kn=O,Gn=Q,qn=qe,$n=en,Wn=Le,Yn=cn,Vn=zn.CONFIGURABLE,Jn=An.get,Xn=An.enforce,Qn=String(String).split("String");(tn.exports=function(e,t,n,a){var r,s=!!a&&!!a.unsafe,o=!!a&&!!a.enumerable,i=!!a&&!!a.noTargetGet,l=a&&void 0!==a.name?a.name:t;Gn(n)&&("Symbol("===String(l).slice(0,7)&&(l="["+String(l).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!qn(n,"name")||Vn&&n.name!==l)&&$n(n,"name",l),(r=Xn(n)).source||(r.source=Qn.join("string"==typeof l?l:""))),e!==Kn?(s?!i&&e[t]&&(o=!0):delete e[t],o?e[t]=n:$n(e,t,n)):o?e[t]=n:Wn(t,n)})(Function.prototype,"toString",(function(){return Gn(this)&&Jn(this).source||Yn(this)}));var Zn={},ea=Math.ceil,ta=Math.floor,na=function(e){var t=+e;return t!=t||0===t?0:(t>0?ta:ea)(t)},aa=na,ra=Math.max,sa=Math.min,oa=na,ia=Math.min,la=function(e){return e>0?ia(oa(e),9007199254740991):0},ca=la,ua=X,da=function(e,t){var n=aa(e);return n<0?ra(n+t,0):sa(n,t)},ma=function(e){return ca(e.length)},ha=function(e){return function(t,n,a){var r,s=ua(t),o=ma(s),i=da(a,o);if(e&&n!=n){for(;o>i;)if((r=s[i++])!=r)return!0}else for(;o>i;i++)if((e||i in s)&&s[i]===n)return e||i||0;return!e&&-1}},pa={includes:ha(!0),indexOf:ha(!1)},fa=qe,ba=X,ga=pa.indexOf,ya=yn,va=w([].push),Ma=function(e,t){var n,a=ba(e),r=0,s=[];for(n in a)!fa(ya,n)&&fa(a,n)&&va(s,n);for(;t.length>r;)fa(a,n=t[r++])&&(~ga(s,n)||va(s,n));return s},Ea=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ta=Ma,_a=Ea.concat("length","prototype");Zn.f=Object.getOwnPropertyNames||function(e){return Ta(e,_a)};var wa={};wa.f=Object.getOwnPropertySymbols;var Ca=re,Oa=Zn,Ia=wa,Da=Ht,Sa=w([].concat),ka=Ca("Reflect","ownKeys")||function(e){var t=Oa.f(Da(e)),n=Ia.f;return n?Sa(t,n(e)):t},Pa=qe,Ra=ka,xa=I,ja=jt,La=D,Aa=Q,Na=/#|\.prototype\./,Ua=function(e,t){var n=Ha[Ba(e)];return n==za||n!=Fa&&(Aa(t)?La(t):!!t)},Ba=Ua.normalize=function(e){return String(e).replace(Na,".").toLowerCase()},Ha=Ua.data={},Fa=Ua.NATIVE="N",za=Ua.POLYFILL="P",Ka=Ua,Ga=O,qa=I.f,$a=en,Wa=tn.exports,Ya=Le,Va=function(e,t,n){for(var a=Ra(t),r=ja.f,s=xa.f,o=0;o<a.length;o++){var i=a[o];Pa(e,i)||n&&Pa(n,i)||r(e,i,s(t,i))}},Ja=Ka,Xa=function(e,t){var n,a,r,s,o,i=e.target,l=e.global,c=e.stat;if(n=l?Ga:c?Ga[i]||Ya(i,{}):(Ga[i]||{}).prototype)for(a in t){if(s=t[a],r=e.noTargetGet?(o=qa(n,a))&&o.value:n[a],!Ja(l?a:i+(c?".":"#")+a,e.forced)&&void 0!==r){if(typeof s==typeof r)continue;Va(s,r)}(e.sham||r&&r.sham)&&$a(s,"sham",!0),Wa(n,a,s,e)}},Qa={};Qa[it("toStringTag")]="z";var Za=O,er="[object z]"===String(Qa),tr=Q,nr=H,ar=it("toStringTag"),rr=Za.Object,sr="Arguments"==nr(function(){return arguments}()),or=er?nr:function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=rr(e),ar))?n:sr?nr(t):"Object"==(a=nr(t))&&tr(t.callee)?"Arguments":a},ir=O.String,lr=function(e){if("Symbol"===or(e))throw TypeError("Cannot convert a Symbol value to a string");return ir(e)},cr=Ht,ur=D,dr=O.RegExp,mr=ur((function(){var e=dr("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),hr=mr||ur((function(){return!dr("a","y").sticky})),pr={BROKEN_CARET:mr||ur((function(){var e=dr("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),MISSED_STICKY:hr,UNSUPPORTED_Y:mr},fr={},br=Ma,gr=Ea,yr=Object.keys||function(e){return br(e,gr)},vr=S,Mr=Lt,Er=jt,Tr=Ht,_r=X,wr=yr;fr.f=vr&&!Mr?Object.defineProperties:function(e,t){Tr(e);for(var n,a=_r(t),r=wr(t),s=r.length,o=0;s>o;)Er.f(e,n=r[o++],a[n]);return e};var Cr,Or=re("document","documentElement"),Ir=Ht,Dr=fr,Sr=Ea,kr=yn,Pr=Or,Rr=Tt,xr=gn("IE_PROTO"),jr=function(){},Lr=function(e){return"<script>"+e+"</"+"script>"},Ar=function(e){e.write(Lr("")),e.close();var t=e.parentWindow.Object;return e=null,t},Nr=function(){try{Cr=new ActiveXObject("htmlfile")}catch(e){}var e,t;Nr="undefined"!=typeof document?document.domain&&Cr?Ar(Cr):((t=Rr("iframe")).style.display="none",Pr.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(Lr("document.F=Object")),e.close(),e.F):Ar(Cr);for(var n=Sr.length;n--;)delete Nr.prototype[Sr[n]];return Nr()};kr[xr]=!0;var Ur,Br,Hr=Object.create||function(e,t){var n;return null!==e?(jr.prototype=Ir(e),n=new jr,jr.prototype=null,n[xr]=e):n=Nr(),void 0===t?n:Dr.f(n,t)},Fr=D,zr=O.RegExp,Kr=Fr((function(){var e=zr(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),Gr=D,qr=O.RegExp,$r=Gr((function(){var e=qr("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),Wr=v,Yr=w,Vr=lr,Jr=function(){var e=cr(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Xr=pr,Qr=Re.exports,Zr=Hr,es=An.get,ts=Kr,ns=$r,as=Qr("native-string-replace",String.prototype.replace),rs=RegExp.prototype.exec,ss=rs,os=Yr("".charAt),is=Yr("".indexOf),ls=Yr("".replace),cs=Yr("".slice),us=(Br=/b*/g,Wr(rs,Ur=/a/,"a"),Wr(rs,Br,"a"),0!==Ur.lastIndex||0!==Br.lastIndex),ds=Xr.BROKEN_CARET,ms=void 0!==/()??/.exec("")[1];(us||ms||ds||ts||ns)&&(ss=function(e){var t,n,a,r,s,o,i,l=this,c=es(l),u=Vr(e),d=c.raw;if(d)return d.lastIndex=l.lastIndex,t=Wr(ss,d,u),l.lastIndex=d.lastIndex,t;var m=c.groups,h=ds&&l.sticky,p=Wr(Jr,l),f=l.source,b=0,g=u;if(h&&(p=ls(p,"y",""),-1===is(p,"g")&&(p+="g"),g=cs(u,l.lastIndex),l.lastIndex>0&&(!l.multiline||l.multiline&&"\n"!==os(u,l.lastIndex-1))&&(f="(?: "+f+")",g=" "+g,b++),n=new RegExp("^(?:"+f+")",p)),ms&&(n=new RegExp("^"+f+"$(?!\\s)",p)),us&&(a=l.lastIndex),r=Wr(rs,h?n:l,g),h?r?(r.input=cs(r.input,b),r[0]=cs(r[0],b),r.index=l.lastIndex,l.lastIndex+=r[0].length):l.lastIndex=0:us&&r&&(l.lastIndex=l.global?r.index+r[0].length:a),ms&&r&&r.length>1&&Wr(as,r[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(r[s]=void 0)})),r&&m)for(r.groups=o=Zr(null),s=0;s<m.length;s++)o[(i=m[s])[0]]=r[i[1]];return r});var hs=ss;Xa({target:"RegExp",proto:!0,forced:/./.exec!==hs},{exec:hs});var ps=w,fs=tn.exports,bs=hs,gs=D,ys=it,vs=en,Ms=ys("species"),Es=RegExp.prototype,Ts=w,_s=na,ws=lr,Cs=Y,Os=Ts("".charAt),Is=Ts("".charCodeAt),Ds=Ts("".slice),Ss=function(e){return function(t,n){var a,r,s=ws(Cs(t)),o=_s(n),i=s.length;return o<0||o>=i?e?"":void 0:(a=Is(s,o))<55296||a>56319||o+1===i||(r=Is(s,o+1))<56320||r>57343?e?Os(s,o):a:e?Ds(s,o,o+2):r-56320+(a-55296<<10)+65536}},ks={codeAt:Ss(!1),charAt:Ss(!0)}.charAt,Ps=w,Rs=ze,xs=Math.floor,js=Ps("".charAt),Ls=Ps("".replace),As=Ps("".slice),Ns=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Us=/\$([$&'`]|\d{1,2})/g,Bs=v,Hs=Ht,Fs=Q,zs=H,Ks=hs,Gs=O.TypeError,qs=g,$s=v,Ws=w,Ys=function(e,t,n,a){var r=ys(e),s=!gs((function(){var t={};return t[r]=function(){return 7},7!=""[e](t)})),o=s&&!gs((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[Ms]=function(){return n},n.flags="",n[r]=/./[r]),n.exec=function(){return t=!0,null},n[r](""),!t}));if(!s||!o||n){var i=ps(/./[r]),l=t(r,""[e],(function(e,t,n,a,r){var o=ps(e),l=t.exec;return l===bs||l===Es.exec?s&&!r?{done:!0,value:i(t,n,a)}:{done:!0,value:o(n,t,a)}:{done:!1}}));fs(String.prototype,e,l[0]),fs(Es,r,l[1])}a&&vs(Es[r],"sham",!0)},Vs=D,Js=Ht,Xs=Q,Qs=na,Zs=la,eo=lr,to=Y,no=function(e,t,n){return t+(n?ks(e,t).length:1)},ao=Ie,ro=function(e,t,n,a,r,s){var o=n+e.length,i=a.length,l=Us;return void 0!==r&&(r=Rs(r),l=Ns),Ls(s,l,(function(s,l){var c;switch(js(l,0)){case"$":return"$";case"&":return e;case"`":return As(t,0,n);case"'":return As(t,o);case"<":c=r[As(l,1,-1)];break;default:var u=+l;if(0===u)return s;if(u>i){var d=xs(u/10);return 0===d?s:d<=i?void 0===a[d-1]?js(l,1):a[d-1]+js(l,1):s}c=a[u-1]}return void 0===c?"":c}))},so=function(e,t){var n=e.exec;if(Fs(n)){var a=Bs(n,e,t);return null!==a&&Hs(a),a}if("RegExp"===zs(e))return Bs(Ks,e,t);throw Gs("RegExp#exec called on incompatible receiver")},oo=it("replace"),io=Math.max,lo=Math.min,co=Ws([].concat),uo=Ws([].push),mo=Ws("".indexOf),ho=Ws("".slice),po="$0"==="a".replace(/./,"$0"),fo=!!/./[oo]&&""===/./[oo]("a","$0");Ys("replace",(function(e,t,n){var a=fo?"$":"$0";return[function(e,n){var a=to(this),r=null==e?void 0:ao(e,oo);return r?$s(r,e,a,n):$s(t,eo(a),e,n)},function(e,r){var s=Js(this),o=eo(e);if("string"==typeof r&&-1===mo(r,a)&&-1===mo(r,"$<")){var i=n(t,s,o,r);if(i.done)return i.value}var l=Xs(r);l||(r=eo(r));var c=s.global;if(c){var u=s.unicode;s.lastIndex=0}for(var d=[];;){var m=so(s,o);if(null===m)break;if(uo(d,m),!c)break;""===eo(m[0])&&(s.lastIndex=no(o,Zs(s.lastIndex),u))}for(var h,p="",f=0,b=0;b<d.length;b++){for(var g=eo((m=d[b])[0]),y=io(lo(Qs(m.index),o.length),0),v=[],M=1;M<m.length;M++)uo(v,void 0===(h=m[M])?h:String(h));var E=m.groups;if(l){var T=co([g],v,y,o);void 0!==E&&uo(T,E);var _=eo(qs(r,void 0,T))}else _=ro(g,o,y,v,E,r);y>=f&&(p+=ho(o,f,y)+_,f=y+g.length)}return p+ho(o,f)}]}),!!Vs((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!po||fo);const bo="en-us";let go=bo;const yo={};function vo(e){var t;return null!==(t=yo[go][e])&&void 0!==t?t:yo["en-us"][e]}function Mo(e){return yo[go][e]}let Eo;function To(e,t){const n=function(e){return null==e?void 0:e.replace("_","-").toLowerCase()}(e);if(n&&Eo)return yo[n]?(go=n,void t()):void function(e,t){try{const n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",e,!0),n.onreadystatechange=function(){4===n.readyState&&200===n.status?t(null,n.responseText):4===n.readyState&&t(new Error("Unable to download locale"))},n.send(null)}catch(e){t(new Error("Unable to download locale"))}}(Eo.localePath("".concat(n,".json")),((e,a)=>{try{if(!e&&a){const e=JSON.parse(a);yo[n]=e,go=n}}catch(e){t()}t()}))}yo[go]={};class _o extends i{add(e){Co(e),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];s({type:"event:subscribe",subscriptions:t})}("portal:new","portal:remove");const t=new wo(e);return this.addIntegration(t),t}}class wo extends o{constructor(e){super(),t(this,"id",""),t(this,"_courseOutlineSelector","course.outline.details"),this.name=e}handleEvent(e){switch(e.type){case"event:event":this.handleUEFEvent(e);break;case"portal:callback":this.handlePortalCallback(e);break;case"course:detail:register":this.handleCourseDetailRegister(e)}}get currentCourseId(){return this._currentCourseId}handleUEFEvent(e){switch(e.eventType){case"portal:new":this.handlePortalNew(e);break;case"portal:remove":this.handlePortalRemove(e)}}handlePortalNew(e){var t;if(e.selector===this._courseOutlineSelector&&this.id===(null===(t=e.selectorData)||void 0===t?void 0:t.registrationId)){var a,r;this._portalId=e.portalId,this._currentCourseId=null===(a=e.selectorData)||void 0===a?void 0:a.courseId;const t=null===(r=e.selectorData)||void 0===r?void 0:r.locale;To(null!=t?t:n.locale,(()=>this.doRender()))}}handlePortalRemove(e){var t;e.selector===this._courseOutlineSelector&&this.id===(null===(t=e.selectorData)||void 0===t?void 0:t.registrationId)&&(this._portalId="")}handlePortalCallback(e){e.portalId===this._portalId&&this.executePortalCallback(e.callbackId)}handleCourseDetailRegister(e){this.name===e.registrationName&&e.registrationId&&(this.id=e.registrationId)}}const Co=e=>{s({type:"course:detail:register",registrationName:e})};class Oo extends EventTarget{constructor(){super(),t(this,"_courseDetails",new _o),t(this,"_panels",new l),t(this,"_modals",new u),t(this,"_factories",[]),this._factories.push(this._panels),this._factories.push(this._courseDetails),this._factories.push(this._modals)}get courseDetails(){return this._courseDetails}get panels(){return this._panels}get modals(){return this._modals}set extension(e){this._extension=e}messageReceived(e){"authorization:authorize"!==e.data.type?this._factories.forEach((t=>t.processEvent(e.data))):this._extension.initialize()}}let Io;const Do=()=>{r().onmessage=Io.messageReceived.bind(Io),s({type:"authorization:authorize",token:n.token})},So=e=>{var t;if(e.origin===n.lmsHost&&e.data&&e.data.type)return"integration:hello"===e.data.type?(t=e.ports[0],a=t,void Do()):void console.warn("Received unknown message ".concat(e.data.type))};var ko=Tt("span").classList,Po=ko&&ko.constructor&&ko.constructor.prototype,Ro=Po===Object.prototype?void 0:Po,xo=Hr,jo=jt,Lo=it("unscopables"),Ao=Array.prototype;null==Ao[Lo]&&jo.f(Ao,Lo,{configurable:!0,value:xo(null)});var No,Uo,Bo,Ho={},Fo=!D((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),zo=O,Ko=qe,Go=Q,qo=ze,$o=Fo,Wo=gn("IE_PROTO"),Yo=zo.Object,Vo=Yo.prototype,Jo=$o?Yo.getPrototypeOf:function(e){var t=qo(e);if(Ko(t,Wo))return t[Wo];var n=t.constructor;return Go(n)&&t instanceof n?n.prototype:t instanceof Yo?Vo:null},Xo=D,Qo=Q,Zo=Jo,ei=tn.exports,ti=it("iterator"),ni=!1;[].keys&&("next"in(Bo=[].keys())?(Uo=Zo(Zo(Bo)))!==Object.prototype&&(No=Uo):ni=!0);var ai=null==No||Xo((function(){var e={};return No[ti].call(e)!==e}));ai&&(No={}),Qo(No[ti])||ei(No,ti,(function(){return this}));var ri={IteratorPrototype:No,BUGGY_SAFARI_ITERATORS:ni},si=jt.f,oi=qe,ii=it("toStringTag"),li=function(e,t,n){e&&!n&&(e=e.prototype),e&&!oi(e,ii)&&si(e,ii,{configurable:!0,value:t})},ci=ri.IteratorPrototype,ui=Hr,di=A,mi=li,hi=Ho,pi=function(){return this},fi=O,bi=Q,gi=fi.String,yi=fi.TypeError,vi=w,Mi=Ht,Ei=function(e){if("object"==typeof e||bi(e))return e;throw yi("Can't set "+gi(e)+" as a prototype")},Ti=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=vi(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,a){return Mi(n),Ei(a),t?e(n,a):n.__proto__=a,n}}():void 0),_i=Xa,wi=v,Ci=zn,Oi=Q,Ii=function(e,t,n,a){var r=t+" Iterator";return e.prototype=ui(ci,{next:di(+!a,n)}),mi(e,r,!1),hi[r]=pi,e},Di=Jo,Si=Ti,ki=li,Pi=en,Ri=tn.exports,xi=Ho,ji=Ci.PROPER,Li=Ci.CONFIGURABLE,Ai=ri.IteratorPrototype,Ni=ri.BUGGY_SAFARI_ITERATORS,Ui=it("iterator"),Bi="keys",Hi="values",Fi="entries",zi=function(){return this},Ki=X,Gi=function(e){Ao[Lo][e]=!0},qi=Ho,$i=An,Wi=jt.f,Yi=function(e,t,n,a,r,s,o){Ii(n,t,a);var i,l,c,u=function(e){if(e===r&&f)return f;if(!Ni&&e in h)return h[e];switch(e){case Bi:case Hi:case Fi:return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",m=!1,h=e.prototype,p=h[Ui]||h["@@iterator"]||r&&h[r],f=!Ni&&p||u(r),b="Array"==t&&h.entries||p;if(b&&(i=Di(b.call(new e)))!==Object.prototype&&i.next&&(Di(i)!==Ai&&(Si?Si(i,Ai):Oi(i[Ui])||Ri(i,Ui,zi)),ki(i,d,!0)),ji&&r==Hi&&p&&p.name!==Hi&&(Li?Pi(h,"name",Hi):(m=!0,f=function(){return wi(p,this)})),r)if(l={values:u(Hi),keys:s?f:u(Bi),entries:u(Fi)},o)for(c in l)(Ni||m||!(c in h))&&Ri(h,c,l[c]);else _i({target:t,proto:!0,forced:Ni||m},l);return h[Ui]!==f&&Ri(h,Ui,f,{name:r}),xi[t]=f,l},Vi=S,Ji="Array Iterator",Xi=$i.set,Qi=$i.getterFor(Ji),Zi=Yi(Array,"Array",(function(e,t){Xi(this,{type:Ji,target:Ki(e),index:0,kind:t})}),(function(){var e=Qi(this),t=e.target,n=e.kind,a=e.index++;return!t||a>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:a,done:!1}:"values"==n?{value:t[a],done:!1}:{value:[a,t[a]],done:!1}}),"values"),el=qi.Arguments=qi.Array;if(Gi("keys"),Gi("values"),Gi("entries"),Vi&&"values"!==el.name)try{Wi(el,"name",{value:"values"})}catch(e){}var tl=O,nl={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},al=Ro,rl=Zi,sl=en,ol=it,il=ol("iterator"),ll=ol("toStringTag"),cl=rl.values,ul=function(e,t){if(e){if(e[il]!==cl)try{sl(e,il,cl)}catch(t){e[il]=cl}if(e[ll]||sl(e,ll,t),nl[t])for(var n in rl)if(e[n]!==rl[n])try{sl(e,n,rl[n])}catch(t){e[n]=rl[n]}}};for(var dl in nl)ul(tl[dl]&&tl[dl].prototype,dl);ul(al,"DOMTokenList");const ml={"enable-ms-teams.svg":"enable-ms-teams.206f3e04.svg","ms-teams-icon.svg":"ms-teams-icon.eb02a05d.svg","ar-sa.json":"ar-sa.5def4a3b.json","az-az.json":"az-az.c9ffd942.json","cs-cz.json":"cs-cz.3f07778b.json","cy-gb.json":"cy-gb.f21fb97b.json","da-dk.json":"da-dk.0e825467.json","de-de.json":"de-de.28dd47d0.json","en-au.json":"en-au.a0700763.json","en-gb.json":"en-gb.007229ed.json","en-us-k12.json":"en-us-k12.40d0092f.json","en-us-pro.json":"en-us-pro.5da29d48.json","en-us.json":"en-us.e7439838.json","es-es.json":"es-es.83b4f33d.json","fr-ca.json":"fr-ca.ed387d48.json","fr-fr.json":"fr-fr.62d22c5d.json","he-il.json":"he-il.8b66b4a7.json","it-it.json":"it-it.62ab2b7c.json","ja-jp.json":"ja-jp.ed2abaf5.json","ko-kr.json":"ko-kr.7f8548c6.json","ms-my.json":"ms-my.95ae4c92.json","nb-no.json":"nb-no.15faa1e2.json","nl-nl.json":"nl-nl.f699a30c.json","nn-no.json":"nn-no.35fa8c4f.json","pl-pl.json":"pl-pl.9012a778.json","pt-br.json":"pt-br.eb429a2c.json","pt-pt.json":"pt-pt.62dfc903.json","ru-ru.json":"ru-ru.248883da.json","sv-se.json":"sv-se.1b0b3dc9.json","th-th.json":"th-th.b63c895d.json","tr-tr.json":"tr-tr.45f79c02.json","uk-ua.json":"uk-ua.00c469f5.json","zh-cn.json":"zh-cn.099eadd8.json","zh-tw.json":"zh-tw.a918b359.json"};function hl(e,t){return ml[t]?"".concat(n.assets,"/").concat(e,"/").concat(ml[t]):"".concat(n.assets,"/").concat(e,"/").concat(t)}function pl(e){return hl("img",e)}function fl(e){return hl("locales",e)}let bl;!function(e){e[e.NoInstructor=0]="NoInstructor",e[e.TooLarge=1]="TooLarge",e[e.None=2]="None"}(bl||(bl={}));const gl=e=>{let{callbackId:t,label:n,altText:a,details:r,disabled:s=!1,additionalDetails:o}=e;const i=[];if(o&&i.push({tag:"div",props:{style:{color:"#767676",fontSize:"0.75rem"}},children:o}),t===_l)return function(e,t,n){const a={tag:"div",props:{className:"uef--course-details--menu-container"},children:[{tag:"ActionMenu",props:{items:[{name:vo("CourseDetailsOpenMeetingsLabel"),callbackId:_l},{name:vo("CourseDetailsOpenClassesLabel"),callbackId:wl}],label:e,analyticsId:"msTeamsExtension",className:"uef--action-menu--labeled",labelClassName:"uef--course-details--menu-label"}}]};return{tag:"div",props:{className:"uef--course-details--element-card"},children:yl(a,t,n)}}(r,a,n);const l=yl({tag:"div",props:{className:"uef--course-details--content"},children:[{tag:"div",props:{className:"uef--course-details--link"},children:r},...i]},a,n);return{tag:"button",props:{disabled:s,className:"uef--button--course-details ".concat(s?"uef--button--disabled":""),onClick:t?{callbackId:t,mode:"sync"}:void 0},children:l}};function yl(e,t,n){return[{tag:"div",props:{className:"uef--course-details--image"},children:[{tag:"img",props:{alt:t,src:pl("ms-teams-icon.svg")}}]},{tag:"div",props:{className:"uef--course-details--element"},children:[{tag:"div",props:{className:"uef--course-details--name"},children:n},e]}]}const vl=e=>{const t=gl(e);return e.instructorContent?function(e,t){let n=[{name:vo("CourseDetailsDisableButtonLabel"),callbackId:Ml}];return t.hasUnsyncedMembers&&(n=[{name:vo("CourseDetailsResyncMembersButtonLabel"),callbackId:El},...n]),{tag:"div",props:{className:"uef--course-details--container"},children:[e,{tag:"ActionMenu",props:{items:n}}]}}(t,e):t},Ml="microsoft-teams-integration:course-details:disable",El="microsoft-teams-integration:course-details:resync-members",Tl="microsoft-teams-integration:course-details:open-panel",_l="microsoft-teams-integration:course-details:open-meetings",wl="microsoft-teams-integration:course-details:view";function Cl(e,t){const n=function(e){switch(e){case bl.NoInstructor:return Mo("CourseDetailsNoInstructorMessage");case bl.TooLarge:return Mo("CourseDetailsCourseTooLargeMessage");case bl.None:return}}(null!=t?t:bl.None);return vl({callbackId:Tl,label:vo("CourseDetailsButtonName"),altText:vo("CourseDetailsImageAlt"),details:vo("CourseDetailsEnableButtonLabel"),disabled:e,additionalDetails:n})}function Ol(){return vl({callbackId:_l,label:vo("CourseDetailsButtonName"),altText:vo("CourseDetailsImageAlt"),details:vo("CourseDetailsViewButtonLabel"),disabled:!1,instructorContent:!1})}const Il=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dl.INFO;t===Dl.INFO?console.log(e):t===Dl.ERROR&&console.error(e)};let Dl;!function(e){e[e.INFO=0]="INFO",e[e.ERROR=1]="ERROR"}(Dl||(Dl={}));class Sl{constructor(e,t,n){this._tokenAuthentication=e,this._lmsHost=t,this._path=n}getUrl(){return"".concat(this._lmsHost).concat(this._path)}async learnRequestInternal(e){var t;const n=null!==(t=null==e?void 0:e.method)&&void 0!==t?t:"GET",a={Authorization:"Bearer ".concat(this._tokenAuthentication.getToken())};null!=e&&e.body&&(a["Content-Type"]="application/json");const r=new Request("".concat(this._lmsHost).concat(this._path),{method:n,body:null==e?void 0:e.body,headers:a});return Il("DEBUG: Fetching response for request: "+JSON.stringify(r)),fetch(r)}async sendRequest(e){return await this._tokenAuthentication.refreshToken(),this.learnRequestInternal(e)}get(){return this.sendRequest({method:"GET"})}patch(e){return this.sendRequest({method:"PATCH",body:JSON.stringify(e)})}put(e){return this.sendRequest({method:"PUT",body:JSON.stringify(e)})}}class kl{constructor(e,t,n,a){this._lmsHost=e,this._currentToken=t,this._tokenExpiration=n,this._tokenRefresh=a}getToken(){return this._currentToken}refreshTokenRequest(){const e={lmsServer:this._lmsHost,refreshToken:this._tokenRefresh};let t=window.location.origin;"/"!==t.charAt(t.length-1)&&(t+="/");const n="".concat(t,"refreshToken"),a=new Request(n,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});return fetch(a)}refreshToken(){return this._tokenRefresh?!(e=this._tokenExpiration)||e<=Date.now()?this.refreshTokenRequest().then((e=>e.ok?e.json():(console.log("Refresh token failed"),{accessToken:void 0,expiresAt:void 0,refreshToken:void 0}))).then((e=>{this._currentToken=e.accessToken,this._tokenExpiration=e.expiresAt,this._tokenRefresh=e.refreshToken})):Promise.resolve():(console.log("There is no refresh token available. Not refreshing token"),Promise.reject(new Error("No token available to use for refreshing")));var e}}const Pl=new class{constructor(){this._store=new Map}getByUrl(e){return this._store.get(e)}has(e){return this._store.has(e)}put(e,t){return this._store.set(e,t)}clear(){this._store.clear()}};class Rl{constructor(e){this._request=e}async get(){const e=this._request.getUrl(),t=Pl.getByUrl(e);if(t)return Il("DEBUG: Using cached response for ".concat(e," instead of fetching")),t;const n=await this._request.get();return Pl.put(e,n),n}patch(e){return this._request.patch(e)}put(e){return this._request.put(e)}}class xl{constructor(e){this._learnConfig=e,this._tokenAuthorizer=new kl(this._learnConfig.lmsHost,this._learnConfig.currentToken,this._learnConfig.tokenExpiration,this._learnConfig.refreshToken)}api(e){return new Sl(this._tokenAuthorizer,this._learnConfig.lmsHost,e)}cachedApi(e){return new Rl(new Sl(this._tokenAuthorizer,this._learnConfig.lmsHost,e))}}let jl;function Ll(){var e,t,a,r;return jl||(jl=new xl({lmsHost:null!==(e=n.lmsHost)&&void 0!==e?e:"",currentToken:null!==(t=n.token)&&void 0!==t?t:"",refreshToken:null!==(a=n.tokenRefresh)&&void 0!==a?a:"",tokenExpiration:null!==(r=n.tokenExpiration)&&void 0!==r?r:0}),jl)}async function Al(e){return(await Ll().api("/learn/api/v1/courses/".concat(e,"/entitlements/").concat("course.cloud.o365.teams.MODIFY")).get()).ok}async function Nl(e,t){if(!(await Ll().api("/learn/api/v1/schoolDataSync/teams/".concat(e)).patch(t)).ok)throw new Error("PATCH Team Configuration request failed")}function Ul(e,t,n){const a=[];return n.forEach((e=>{var t;a.push({tag:"button",props:{onClick:{callbackId:(t=e).callbackId},className:t.className,style:{marginBottom:"0px"}},children:t.label})})),{tag:"Modal",props:{width:"medium"},children:[{tag:"ModalHeader",props:{title:e}},{tag:"ModalBody",children:[{tag:"div",props:{},children:t}]},{tag:"ModalFooter",children:a}]}}const Bl="microsoft-teams-integration:disable-modal:confirm",Hl="microsoft-teams-integration:disable-modal:cancel";const Fl="microsoft-teams-integration:sync-error-modal:dismiss",zl="microsoft-teams-integration:sync-error-modal:confirm";const Kl="microsoft-teams-integration:error-modal:dismiss";class Gl{constructor(e,t){this._ultraExtension=e,this._courseDetails=t,this._disableModal=this._ultraExtension.modals.create("ms-teams:modals:disable"),this._disableModal.addPortalCallback(Hl,(()=>{this._disableModal.close()})),this._disableModal.addPortalCallback(Bl,(()=>{this.disableTeamsOnCurrentCourse()})),this._disableModal.render((e=>{e(Ul(vo("DisableTeamsModalHeader"),vo("DisableTeamsModalDetails"),[{callbackId:Hl,className:"uef--button--secondary",label:vo("DisableTeamsModalCancelButtonLabel")},{callbackId:Bl,className:"uef--button",label:vo("DisableTeamsModalConfirmButtonLabel")}]))}))}async disableTeamsOnCurrentCourse(){if(!this._courseDetails.currentCourseId)throw new Error("Course ID was not set on disable modal");try{await Nl(this._courseDetails.currentCourseId,{enabled:!1});const e={enabled:!1};this._courseDetails.doRender(void 0,{teamConfig:e})}catch{Il("Unable to disable Microsoft Teams",Dl.ERROR)}finally{this._disableModal.close()}}open(){this._disableModal.open()}}let ql;!function(e){e.SyncErrorAndMissingOrDuplicateEmail="SyncErrorAndMissingOrDuplicateEmail",e.SyncError="SyncError",e.MissingOrDuplicateEmail="MissingOrDuplicateEmail",e.UnsyncedMembers="UnsyncedMembers",e.UnsyncedMembersAndMissingOrDuplicateEmail="UnsyncedMembersAndMissingOrDuplicateEmail",e.TeamCreationError="TeamCreationError",e.ResyncMembersError="ResyncMembersError",e.None="None"}(ql||(ql={}));class $l{constructor(e,t){this._modalLocalStorage=e,this._errorModal=t,this.modalErrorType=ql.None}open(){var e;this.shouldShowErrorModalType&&(null===(e=this._modalLocalStorage)||void 0===e||e.setMostRecentModalShown(this.modalErrorType),this._errorModal.open())}get shouldShowErrorModalType(){var e;const t=null===(e=this._modalLocalStorage)||void 0===e?void 0:e.getMostRecentModalShown();return!t||t!==this.modalErrorType}}class Wl{constructor(e,t){this._ultraExtension=e,this._modal=this._ultraExtension.modals.create("ms-teams:modals:unsynced-members"),this._modal.addPortalCallback(Fl,(()=>{this._modal.close()})),this._modal.addPortalCallback(zl,(async()=>{try{await t.onConfirm()}catch{Il("Unable to sync missing course members",Dl.ERROR)}finally{this._modal.close()}})),this._modal.render((e=>{e(Ul(vo("UnsyncedMembersModalHeader"),vo("UnsyncedMembersModalDetails"),[{callbackId:Fl,className:"uef--button--secondary",label:vo("UnsyncedMembersModalDismissButtonLabel")},{callbackId:zl,className:"uef--button",label:vo("UnsyncedMembersModalConfirmButtonLabel")}]))}))}open(){this._modal.open()}}class Yl{constructor(e,t,n){this._modal=new Wl(e,t),this._singlePromptErrorModal=new $l(n,this._modal),this._singlePromptErrorModal.modalErrorType=ql.UnsyncedMembers}getErrorModal(){return this._singlePromptErrorModal}}const Vl=new Map([[ql.SyncError,function(){return{title:vo("SyncErrorModalHeader"),details:vo("SyncErrorModalDetails"),dismissButton:vo("SyncErrorModalDismissButtonLabel")}}],[ql.SyncErrorAndMissingOrDuplicateEmail,function(){return{title:vo("SyncErrorAndMissingOrDuplicateEmailModalHeader"),details:"".concat(vo("SyncErrorAndMissingOrDuplicateEmailModalDetails")),dismissButton:vo("SyncErrorAndMissingOrDuplicateEmailModalOK")}}],[ql.MissingOrDuplicateEmail,function(){return{title:vo("MissingOrDuplicateEmailModalHeader"),details:vo("MissingOrDuplicateEmailModalDetails"),dismissButton:vo("MissingOrDuplicateEmailModalOK")}}],[ql.UnsyncedMembersAndMissingOrDuplicateEmail,function(){return{title:vo("UnsyncedMembersAndMissingOrDuplicateEmailModalHeader"),details:"".concat(vo("UnsyncedMembersAndMissingOrDuplicateEmailModalDetails")),dismissButton:vo("UnsyncedMembersAndMissingOrDuplicateEmailModalOK")}}],[ql.TeamCreationError,function(){return{title:vo("EnableTeamsFailedModalHeader"),details:vo("EnableTeamsFailedModalDetails"),dismissButton:vo("EnableTeamsFailedModalOK")}}],[ql.ResyncMembersError,function(){return{title:vo("ResyncMembersErrorModalHeader"),details:vo("ResyncMembersErrorModalDetails"),dismissButton:vo("ResyncMembersErrorModalDismissButtonLabel")}}]]);class Jl{constructor(e){this._ultraExtension=e,this._currentLabels={title:"",details:"",dismissButton:""},this._modal=this._ultraExtension.modals.create("ms-teams:modals:error"),this._modal.addPortalCallback(Kl,(()=>{this._modal.close()})),this._modal.render((e=>{e(function(e){let{title:t,details:n,dismissButton:a}=e;return Ul(t,n,[{callbackId:Kl,className:"uef--button",label:a}])}(this._currentLabels))}))}set labels(e){this._currentLabels=e}open(){this._modal.open()}}class Xl{constructor(e,t){this._modal=new Jl(e),this._singlePromptErrorModal=new $l(t,this._modal)}getErrorModal(e){this._singlePromptErrorModal.modalErrorType=e;const t=Vl.get(e);return t&&(this._modal.labels=t()),this._singlePromptErrorModal}}const Ql="microsoft-teams-integration:enable-team-panel:enable-team";let Zl,ec;!function(e){e.ClassNotCreated="ClassNotCreated",e.TeamNotCreated="TeamNotCreated",e.PartialMembers="PartialMembers"}(Zl||(Zl={})),function(e){e.InProgress="In Progress",e.Completed="Completed",e.Failed="Failed"}(ec||(ec={}));var tc="Microsoft Teams",nc="Microsoft Teams",ac="Enable Microsoft Teams",rc="Open Microsoft Teams",sc="Open Microsoft Teams meetings",oc="Open Microsoft Teams classes",ic="Setting Up Teams",lc="This course needs to have a designated instructor before you can enable Microsoft Teams.",cc="You can't enable Microsoft Teams for this course because it exceeds the maximum member capacity.",uc="Microsoft Teams",dc="Let's get you set up with Microsoft Teams",mc="Microsoft Teams is a collaborative workspace you can use in your course",hc="Your class roster will sync automatically with Microsoft Teams",pc="Upload or create shared Office documents for collaborative work",fc="Create class discussions and class notebooks",bc="You just need to sync your course to Microsoft Teams, and get started exploring the tool.",gc="Sync with Microsoft Teams",yc="Learn more on how to use Microsoft Teams within Learn Ultra",vc="https://help.blackboard.com/Learn/Administrator/SaaS/Integrations/Microsoft_Classes/FAQ",Mc="Microsoft Teams Classes",Ec="Microsoft Teams Meetings",Tc="Disable Microsoft Teams",_c="Resynchronize course members",wc="Microsoft Teams",Cc="Great! We are setting up your Teams account!",Oc="Wait a moment while we pull it together.  It can take up to 15 minutes to set up Microsoft Teams for your class.",Ic="Got it!",Dc="Are you sure you want to disable Microsoft Teams for this course?",Sc="Microsoft Teams won't be deleted, but students won't have easy access from Ultra.",kc="Cancel",Pc="Yes, disable",Rc="Oops! Something went wrong.",xc="There was an error during the team's creation. Please try to enable Microsoft Teams again.",jc="Synchronization failed!",Lc="Please try to enable Microsoft Teams again.",Ac="Resynchronization failed!",Nc="Please try to resynchronize course members again.",Uc="Synchronize course members?",Bc="Some of your course members don't have access to Microsoft Teams within Learn Ultra yet. Do you want to resynchronize Microsoft Teams to include them? You'll be available to do so at any time via the three dot menu.",Hc="Cancel",Fc="Synchronize",zc="Not quite ready yet!",Kc="Your Microsoft Team is ready to go, but some members weren't included because their profile email is either duplicated, missing, or invalid. Please contact your system administrator.",Gc="Team sync failed!",qc="Some members weren't included because their profile email is either duplicated, missing, or invalid. You could be part of this group. Please try again. If the issue persists, contact your system administrator.",$c="Team sync partially completed!",Wc="Some members weren't included because their profile email is either duplicated, missing, or invalid. You could be part of this group. Please try to resynchronize Microsoft Teams. If the issue persists, contact your system administrator.",Yc={CourseDetailsButtonName:tc,CourseDetailsImageAlt:nc,CourseDetailsEnableButtonLabel:ac,CourseDetailsViewButtonLabel:rc,CourseDetailsOpenMeetingsLabel:sc,CourseDetailsOpenClassesLabel:oc,CourseDetailsInProgressButtonLabel:ic,CourseDetailsNoInstructorMessage:lc,CourseDetailsCourseTooLargeMessage:cc,EnableTeamPanelTitle:uc,EnableTeamPanelHeader:dc,EnableTeamPanelMSTeamsDefinition:mc,EnableTeamPanelSyncDetails:hc,EnableTeamPanelOfficeFeature:pc,EnableTeamPanelTeamsTools:fc,EnableTeamPanelInstructions:bc,EnableTeamPanelButton:gc,EnableTeamHelpLinkLabel:yc,EnableTeamHelpLinkUrl:vc,TeamsClassesPanelTitle:Mc,TeamsMeetingsPanelTitle:Ec,CourseDetailsDisableButtonLabel:Tc,CourseDetailsResyncMembersButtonLabel:_c,TeamEnabledSuccessPanelTitle:wc,TeamEnabledSuccessPanelMessage:Cc,TeamEnabledSuccessPanelSubMessage:Oc,TeamEnabledSuccessPanelButton:Ic,DisableTeamsModalHeader:Dc,DisableTeamsModalDetails:Sc,DisableTeamsModalCancelButtonLabel:kc,DisableTeamsModalConfirmButtonLabel:Pc,EnableTeamsFailedModalHeader:Rc,EnableTeamsFailedModalDetails:xc,EnableTeamsFailedModalOK:"OK",SyncErrorModalHeader:jc,SyncErrorModalDetails:Lc,SyncErrorModalDismissButtonLabel:"OK",ResyncMembersErrorModalHeader:Ac,ResyncMembersErrorModalDetails:Nc,ResyncMembersErrorModalDismissButtonLabel:"OK",UnsyncedMembersModalHeader:Uc,UnsyncedMembersModalDetails:Bc,UnsyncedMembersModalDismissButtonLabel:Hc,UnsyncedMembersModalConfirmButtonLabel:Fc,MissingOrDuplicateEmailModalHeader:zc,MissingOrDuplicateEmailModalDetails:Kc,MissingOrDuplicateEmailModalOK:"OK",SyncErrorAndMissingOrDuplicateEmailModalHeader:Gc,SyncErrorAndMissingOrDuplicateEmailModalDetails:qc,SyncErrorAndMissingOrDuplicateEmailModalOK:"OK",UnsyncedMembersAndMissingOrDuplicateEmailModalHeader:$c,UnsyncedMembersAndMissingOrDuplicateEmailModalDetails:Wc,UnsyncedMembersAndMissingOrDuplicateEmailModalOK:"OK"},Vc=Object.freeze({__proto__:null,CourseDetailsButtonName:tc,CourseDetailsImageAlt:nc,CourseDetailsEnableButtonLabel:ac,CourseDetailsViewButtonLabel:rc,CourseDetailsOpenMeetingsLabel:sc,CourseDetailsOpenClassesLabel:oc,CourseDetailsInProgressButtonLabel:ic,CourseDetailsNoInstructorMessage:lc,CourseDetailsCourseTooLargeMessage:cc,EnableTeamPanelTitle:uc,EnableTeamPanelHeader:dc,EnableTeamPanelMSTeamsDefinition:mc,EnableTeamPanelSyncDetails:hc,EnableTeamPanelOfficeFeature:pc,EnableTeamPanelTeamsTools:fc,EnableTeamPanelInstructions:bc,EnableTeamPanelButton:gc,EnableTeamHelpLinkLabel:yc,EnableTeamHelpLinkUrl:vc,TeamsClassesPanelTitle:Mc,TeamsMeetingsPanelTitle:Ec,CourseDetailsDisableButtonLabel:Tc,CourseDetailsResyncMembersButtonLabel:_c,TeamEnabledSuccessPanelTitle:wc,TeamEnabledSuccessPanelMessage:Cc,TeamEnabledSuccessPanelSubMessage:Oc,TeamEnabledSuccessPanelButton:Ic,DisableTeamsModalHeader:Dc,DisableTeamsModalDetails:Sc,DisableTeamsModalCancelButtonLabel:kc,DisableTeamsModalConfirmButtonLabel:Pc,EnableTeamsFailedModalHeader:Rc,EnableTeamsFailedModalDetails:xc,EnableTeamsFailedModalOK:"OK",SyncErrorModalHeader:jc,SyncErrorModalDetails:Lc,SyncErrorModalDismissButtonLabel:"OK",ResyncMembersErrorModalHeader:Ac,ResyncMembersErrorModalDetails:Nc,ResyncMembersErrorModalDismissButtonLabel:"OK",UnsyncedMembersModalHeader:Uc,UnsyncedMembersModalDetails:Bc,UnsyncedMembersModalDismissButtonLabel:Hc,UnsyncedMembersModalConfirmButtonLabel:Fc,MissingOrDuplicateEmailModalHeader:zc,MissingOrDuplicateEmailModalDetails:Kc,MissingOrDuplicateEmailModalOK:"OK",SyncErrorAndMissingOrDuplicateEmailModalHeader:Gc,SyncErrorAndMissingOrDuplicateEmailModalDetails:qc,SyncErrorAndMissingOrDuplicateEmailModalOK:"OK",UnsyncedMembersAndMissingOrDuplicateEmailModalHeader:$c,UnsyncedMembersAndMissingOrDuplicateEmailModalDetails:Wc,UnsyncedMembersAndMissingOrDuplicateEmailModalOK:"OK",default:Yc});class Jc{constructor(e){this._getCourseId=e}get storageKey(){return"".concat(this._getCourseId(),"_ModalType")}setMostRecentModalShown(e){window.localStorage.setItem(this.storageKey,e)}getMostRecentModalShown(){return window.localStorage.getItem(this.storageKey)}}class Xc{constructor(e){e.extension=this,this._ultraExtension=e}initialize(){var e;e={baseResources:Vc,localePath:fl},yo["en-us"]=e.baseResources,Eo=e,To(n.locale,(()=>{Il("Initializing MS Teams Extension"),this._courseDetails=this._ultraExtension.courseDetails.add("Microsoft Teams"),this._courseDetails.addPortalCallback(wl,this.onOpenTeamsClasses.bind(this)),this._courseDetails.addPortalCallback(Tl,this.onOpenEnableTeamPanel.bind(this)),this._courseDetails.addPortalCallback(Ml,this.onOpenDisableTeamModal.bind(this)),this._courseDetails.addPortalCallback(El,this.onResyncMissingMembers.bind(this)),this._courseDetails.addPortalCallback(_l,this.onOpenTeamsMeetings.bind(this)),this._courseDetails.render(this.calculateContent.bind(this)),this._enableTeamPanel=this._ultraExtension.panels.create("ms-teams:course:enable-team-panel"),this._enableTeamPanel.addPortalCallback(Ql,this.onEnableTeamPanelSubmit.bind(this)),this._enableTeamPanel.render((e=>e({tag:"div",props:{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},children:[{tag:"img",props:{width:182,height:200,style:{marginBottom:"10px"},src:pl("enable-ms-teams.svg")}},{tag:"h2",props:{style:{marginBottom:"20px",fontSize:"1.375rem",fontFamily:"Open Sans",textAlign:"center"}},children:vo("EnableTeamPanelHeader")},{tag:"p",props:{style:{marginBottom:"8px",fontSize:"1.125rem",lineHeight:"1.4",textAlign:"center"}},children:vo("EnableTeamPanelMSTeamsDefinition")},{tag:"ul",style:{marginBottom:"28px",lineHeight:"1.4",textAlign:"center"},children:[{tag:"li",props:{style:{marginBottom:"8px"}},children:vo("EnableTeamPanelSyncDetails")},{tag:"li",props:{style:{marginBottom:"8px"}},children:vo("EnableTeamPanelOfficeFeature")},{tag:"li",children:vo("EnableTeamPanelTeamsTools")}]},{tag:"p",props:{style:{marginBottom:"22px",lineHeight:"1.4",textAlign:"center",fontSize:"1.125rem",fontWeight:600}},children:vo("EnableTeamPanelInstructions")},{tag:"button",props:{style:{marginBottom:"40px"},className:"uef--button",onClick:{callbackId:Ql}},children:vo("EnableTeamPanelButton")},{tag:"a",props:{href:vo("EnableTeamHelpLinkUrl")},children:vo("EnableTeamHelpLinkLabel")}]}))),this._viewTeamsClassesPanel=this._ultraExtension.panels.create("ms-teams:course:view-team-classes-panel"),this._viewTeamsClassesPanel.render((e=>{var t;e({tag:"LtiLaunch",props:{handle:null===(t=n.ltiHandlers)||void 0===t?void 0:t.teamsClasses,courseId:this.currentCourseId,style:{width:"100%",height:"100%"}}})})),this._viewTeamsMeetingsPanel=this._ultraExtension.panels.create("ms-teams:course:view-team-meetings-panel"),this._viewTeamsMeetingsPanel.render((e=>{var t;e({tag:"LtiLaunch",props:{handle:null===(t=n.ltiHandlers)||void 0===t?void 0:t.teamsMeetings,courseId:this.currentCourseId,style:{width:"100%",height:"100%"}}})})),this._modalLocalStorage=new Jc((()=>this.currentCourseId)),this._errorModalFactory=new Xl(this._ultraExtension,this._modalLocalStorage),this._unsyncedMembersModalFactory=new Yl(this._ultraExtension,{onConfirm:this.enableTeam.bind(this)},this._modalLocalStorage),this._disableModal=new Gl(this._ultraExtension,this._courseDetails)}))}get currentCourseId(){var e,t;return null!==(e=null===(t=this._courseDetails)||void 0===t?void 0:t.currentCourseId)&&void 0!==e?e:""}async validateCanEnableTeams(){var e,t,n;const a=await async function(e){const t=await Ll().api("/learn/api/v1/courses/".concat(e,"/memberships/counts")).get();try{if(!t.ok)return;return await t.json()}catch{return}}(this.currentCourseId);return(null!==(e=null==a?void 0:a.count)&&void 0!==e?e:0)>1e4?{canEnableTeams:!1,error:bl.TooLarge}:(null!==(t=null==a||null===(n=a.results)||void 0===n?void 0:n.INSTRUCTOR)&&void 0!==t?t:0)<1?{canEnableTeams:!1,error:bl.NoInstructor}:{canEnableTeams:!0}}async enableTeam(){var e,t;await Nl(this.currentCourseId,{enabled:!0});const n={enabled:!0,status:ec.InProgress};null===(e=this._modalLocalStorage)||void 0===e||e.setMostRecentModalShown(ql.None),null===(t=this._courseDetails)||void 0===t||t.doRender(void 0,{teamConfig:n,courseIsCompleted:!1})}onOpenTeamsClasses(){var e;this._viewTeamsClassesPanel.open({panelTitle:vo("TeamsClassesPanelTitle"),panelSubtitle:null===(e=this._currentCourse)||void 0===e?void 0:e.displayName,useCustomPadding:!0})}onOpenTeamsMeetings(){var e;this._viewTeamsMeetingsPanel.open({panelTitle:vo("TeamsMeetingsPanelTitle"),panelSubtitle:null===(e=this._currentCourse)||void 0===e?void 0:e.displayName,useCustomPadding:!0})}onOpenEnableTeamPanel(){var e;this._enableTeamPanel.open({panelTitle:vo("EnableTeamPanelTitle"),panelSubtitle:null===(e=this._currentCourse)||void 0===e?void 0:e.displayName})}onOpenDisableTeamModal(){var e;null===(e=this._disableModal)||void 0===e||e.open()}async onEnableTeamPanelSubmit(){try{await this.enableTeam(),this._enableTeamPanel.close()}catch(t){var e;Il(t,Dl.ERROR),null===(e=this.getErrorModal(ql.TeamCreationError))||void 0===e||e.open()}}async onResyncMissingMembers(){try{await this.enableTeam()}catch(t){var e;Il("Unable to resync memberships with Microsoft Teams",Dl.ERROR),null===(e=this.getErrorModal(ql.ResyncMembersError))||void 0===e||e.open()}}async onEnabledConfiguration(e,t,n){var a;e.status===ec.Completed&&n(Ol());let r=!1;try{r=await Al(this.currentCourseId)}catch(e){Il("Learn request failure"),Il(e,Dl.ERROR)}if(!r)return void n(!1);const s=(null===(a=e.error)||void 0===a?void 0:a.code)===Zl.PartialMembers;if(e.status===ec.InProgress)n(vl({callbackId:void 0,label:vo("CourseDetailsButtonName"),altText:vo("CourseDetailsImageAlt"),details:vo("CourseDetailsInProgressButtonLabel"),disabled:!0}));else if(t||e.status!==ec.Completed)if(t&&e.status===ec.Completed)n(Ol());else{const{canEnableTeams:e,error:a}=await this.validateCanEnableTeams();n(Cl(t||!e,a))}else n(function(e){return vl({callbackId:_l,label:vo("CourseDetailsButtonName"),altText:vo("CourseDetailsImageAlt"),details:vo("CourseDetailsViewButtonLabel"),disabled:!1,instructorContent:!0,hasUnsyncedMembers:e})}(s||this.doesTeamHaveUsersWithAnInvalidEmail(e)));var o;if(t||e.status===ec.InProgress)n(!1);else if(s&&this.doesTeamHaveUsersWithAnInvalidEmail(e))null===(o=this.getErrorModal(ql.UnsyncedMembersAndMissingOrDuplicateEmail))||void 0===o||o.open();else if(s){var i;null===(i=this.getErrorModal(ql.UnsyncedMembers))||void 0===i||i.open()}else if(this.doesTeamHaveUsersWithAnInvalidEmail(e)){var l;null===(l=this.getErrorModal(ql.MissingOrDuplicateEmail))||void 0===l||l.open()}else if(e.status===ec.Completed&&!e.error){var c;null===(c=this._modalLocalStorage)||void 0===c||c.setMostRecentModalShown(ql.None)}}async onDisabledConfiguration(e,t,n){try{if(!await Al(this.currentCourseId))return void n(!1);var a;if(!t)if(e.status===ec.Failed&&this.doesTeamHaveUsersWithAnInvalidEmail(e))null===(a=this.getErrorModal(ql.SyncErrorAndMissingOrDuplicateEmail))||void 0===a||a.open();else if(e.status===ec.Failed){var r;null===(r=this.getErrorModal(ql.SyncError))||void 0===r||r.open()}else if(this.doesTeamHaveUsersWithAnInvalidEmail(e)){var s;null===(s=this.getErrorModal(ql.MissingOrDuplicateEmail))||void 0===s||s.open()}const{canEnableTeams:o,error:i}=await this.validateCanEnableTeams();n(Cl(t||!o,i))}catch(e){Il("Learn request failure"),Il(e,Dl.ERROR),n(!1)}}async setCourseAndGetIsCompleted(){var e;return this._currentCourse=await async function(e){const t=await Ll().api("/learn/api/v1/courses/".concat(e)).get();if(t.ok)return await t.json();Il("Unable to fetch data for course: ".concat(t.statusText),Dl.ERROR)}(this.currentCourseId),!(null===(e=this._currentCourse)||void 0===e||!e.isClosed)}async calculateContent(e,t){var n;if(null===(n=this._courseDetails)||void 0===n||!n.currentCourseId)return;let a,r,s;a=null!=t&&t.courseIsCompleted?Promise.resolve(null==t?void 0:t.courseIsCompleted):this.setCourseAndGetIsCompleted(),r=function(e){const t=e;return"boolean"==typeof(null==t?void 0:t.enabled)}(null==t?void 0:t.teamConfig)?Promise.resolve(null==t?void 0:t.teamConfig):async function(e){const t=await Ll().api("/learn/api/v1/schoolDataSync/teams/".concat(e)).get();if(t.ok)return t.json();Il("Unable to get bb-sds-link team configuration: ".concat(t.statusText),Dl.ERROR)}(this.currentCourseId);let o=!1;try{[s,o]=await Promise.all([r,a])}catch(e){Il("Unable to get school data sync configuration or course data",Dl.ERROR),Il(e,Dl.ERROR)}s?s.enabled?await this.onEnabledConfiguration(s,o,e):await this.onDisabledConfiguration(s,o,e):e(!1)}doesTeamHaveUsersWithAnInvalidEmail(e){var t;return!!(null!=e&&e.usersWithAnInvalidEmail&&(null==e||null===(t=e.usersWithAnInvalidEmail)||void 0===t?void 0:t.length)>0)}getErrorModal(e){var t,n;return e==ql.UnsyncedMembers?null===(t=this._unsyncedMembersModalFactory)||void 0===t?void 0:t.getErrorModal():null===(n=this._errorModalFactory)||void 0===n?void 0:n.getErrorModal(e)}}async function Qc(){if(await async function(){const e=await Ll().cachedApi("/learn/api/v1/schoolDataSync").get();if(e.ok){const t=await e.json();return"msTeams"===t.integrationType&&t.integrationEnabled}return Il("Unable to get bb-sds-link tenant configuration: ".concat(e.statusText),Dl.ERROR),!1}()){const e=(()=>{if(!window.parent)throw new Error("Ultra Extension Integrations must execute in an iframe.");if(!n.lmsHost)throw new Error("Learn host is not setup.");return Io=new Oo,window.addEventListener("message",So,!1),window.parent.postMessage({type:"integration:hello"},"".concat(n.lmsHost,"/*")),Io})();new Xc(e)}}Qc(),e.main=Qc,Object.defineProperty(e,"__esModule",{value:!0})}({});